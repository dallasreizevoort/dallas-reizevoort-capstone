{"ast":null,"code":"var _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nfunction useAuth(code, logout, setLogout) {\n  _s();\n  const [accessToken, setAccessToken] = useState();\n  const [refreshToken, setRefreshToken] = useState();\n  const [expiresIn, setExpiresIn] = useState();\n  const [refreshInterval, setRefreshInterval] = useState();\n  useEffect(() => {\n    if (logout) {\n      // Clear the access token, refresh token, and expiration time from the component's state\n      setAccessToken(null);\n      setRefreshToken(null);\n      setExpiresIn(null);\n\n      // Clear the interval that refreshes the access token\n      if (refreshInterval) {\n        clearInterval(refreshInterval);\n        setRefreshInterval(null);\n      }\n      return;\n    }\n    axios.post(\"http://localhost:3001/login\", {\n      code\n    }).then(res => {\n      setAccessToken(res.data.accessToken);\n      setRefreshToken(res.data.refreshToken);\n      setExpiresIn(res.data.expiresIn);\n      window.history.pushState({}, null, \"/\");\n    }).catch(() => {\n      window.location = \"/\";\n    });\n  }, [code, logout]);\n  useEffect(() => {\n    if (!refreshToken || !expiresIn) return;\n    const interval = setInterval(() => {\n      axios.post(\"http://localhost:3001/refresh\", {\n        refreshToken\n      }).then(res => {\n        setAccessToken(res.data.accessToken);\n        setExpiresIn(res.data.expiresIn);\n      }).catch(() => {\n        window.location = \"/\";\n      });\n    }, (expiresIn - 60) * 1000);\n    setRefreshInterval(interval);\n    return () => clearInterval(interval);\n  }, [refreshToken, expiresIn]);\n  return accessToken;\n}\n_s(useAuth, \"YW3bRfMP4EKwWPFymy1q4n3h/Q4=\");\nexport default useAuth;","map":{"version":3,"names":["React","useState","useEffect","axios","useAuth","code","logout","setLogout","_s","accessToken","setAccessToken","refreshToken","setRefreshToken","expiresIn","setExpiresIn","refreshInterval","setRefreshInterval","clearInterval","post","then","res","data","window","history","pushState","catch","location","interval","setInterval"],"sources":["/Users/dallas/BrainStation/dallas-reizevoort-capstone/dallas-reizevoort-capstone-app/src/useAuth.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport axios from \"axios\";\n\nfunction useAuth(code, logout, setLogout) {\n  const [accessToken, setAccessToken] = useState();\n  const [refreshToken, setRefreshToken] = useState();\n  const [expiresIn, setExpiresIn] = useState();\n  const [refreshInterval, setRefreshInterval] = useState();\n\n  useEffect(() => {\n    if (logout) {\n      // Clear the access token, refresh token, and expiration time from the component's state\n      setAccessToken(null);\n      setRefreshToken(null);\n      setExpiresIn(null);\n\n      // Clear the interval that refreshes the access token\n      if (refreshInterval) {\n        clearInterval(refreshInterval);\n        setRefreshInterval(null);\n      }\n\n      return;\n    }\n\n    axios\n      .post(\"http://localhost:3001/login\", {\n        code,\n      })\n      .then((res) => {\n        setAccessToken(res.data.accessToken);\n        setRefreshToken(res.data.refreshToken);\n        setExpiresIn(res.data.expiresIn);\n        window.history.pushState({}, null, \"/\");\n      })\n      .catch(() => {\n        window.location = \"/\";\n      });\n  }, [code, logout]);\n\n  useEffect(() => {\n    if (!refreshToken || !expiresIn) return;\n    const interval = setInterval(() => {\n      axios\n        .post(\"http://localhost:3001/refresh\", {\n          refreshToken,\n        })\n        .then((res) => {\n          setAccessToken(res.data.accessToken);\n          setExpiresIn(res.data.expiresIn);\n        })\n        .catch(() => {\n          window.location = \"/\";\n        });\n    }, (expiresIn - 60) * 1000);\n\n    setRefreshInterval(interval);\n\n    return () => clearInterval(interval);\n  }, [refreshToken, expiresIn]);\n\n  return accessToken;\n}\n\nexport default useAuth;"],"mappings":";AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAClD,OAAOC,KAAK,MAAM,OAAO;AAEzB,SAASC,OAAOA,CAACC,IAAI,EAAEC,MAAM,EAAEC,SAAS,EAAE;EAAAC,EAAA;EACxC,MAAM,CAACC,WAAW,EAAEC,cAAc,CAAC,GAAGT,QAAQ,CAAC,CAAC;EAChD,MAAM,CAACU,YAAY,EAAEC,eAAe,CAAC,GAAGX,QAAQ,CAAC,CAAC;EAClD,MAAM,CAACY,SAAS,EAAEC,YAAY,CAAC,GAAGb,QAAQ,CAAC,CAAC;EAC5C,MAAM,CAACc,eAAe,EAAEC,kBAAkB,CAAC,GAAGf,QAAQ,CAAC,CAAC;EAExDC,SAAS,CAAC,MAAM;IACd,IAAII,MAAM,EAAE;MACV;MACAI,cAAc,CAAC,IAAI,CAAC;MACpBE,eAAe,CAAC,IAAI,CAAC;MACrBE,YAAY,CAAC,IAAI,CAAC;;MAElB;MACA,IAAIC,eAAe,EAAE;QACnBE,aAAa,CAACF,eAAe,CAAC;QAC9BC,kBAAkB,CAAC,IAAI,CAAC;MAC1B;MAEA;IACF;IAEAb,KAAK,CACFe,IAAI,CAAC,6BAA6B,EAAE;MACnCb;IACF,CAAC,CAAC,CACDc,IAAI,CAAEC,GAAG,IAAK;MACbV,cAAc,CAACU,GAAG,CAACC,IAAI,CAACZ,WAAW,CAAC;MACpCG,eAAe,CAACQ,GAAG,CAACC,IAAI,CAACV,YAAY,CAAC;MACtCG,YAAY,CAACM,GAAG,CAACC,IAAI,CAACR,SAAS,CAAC;MAChCS,MAAM,CAACC,OAAO,CAACC,SAAS,CAAC,CAAC,CAAC,EAAE,IAAI,EAAE,GAAG,CAAC;IACzC,CAAC,CAAC,CACDC,KAAK,CAAC,MAAM;MACXH,MAAM,CAACI,QAAQ,GAAG,GAAG;IACvB,CAAC,CAAC;EACN,CAAC,EAAE,CAACrB,IAAI,EAAEC,MAAM,CAAC,CAAC;EAElBJ,SAAS,CAAC,MAAM;IACd,IAAI,CAACS,YAAY,IAAI,CAACE,SAAS,EAAE;IACjC,MAAMc,QAAQ,GAAGC,WAAW,CAAC,MAAM;MACjCzB,KAAK,CACFe,IAAI,CAAC,+BAA+B,EAAE;QACrCP;MACF,CAAC,CAAC,CACDQ,IAAI,CAAEC,GAAG,IAAK;QACbV,cAAc,CAACU,GAAG,CAACC,IAAI,CAACZ,WAAW,CAAC;QACpCK,YAAY,CAACM,GAAG,CAACC,IAAI,CAACR,SAAS,CAAC;MAClC,CAAC,CAAC,CACDY,KAAK,CAAC,MAAM;QACXH,MAAM,CAACI,QAAQ,GAAG,GAAG;MACvB,CAAC,CAAC;IACN,CAAC,EAAE,CAACb,SAAS,GAAG,EAAE,IAAI,IAAI,CAAC;IAE3BG,kBAAkB,CAACW,QAAQ,CAAC;IAE5B,OAAO,MAAMV,aAAa,CAACU,QAAQ,CAAC;EACtC,CAAC,EAAE,CAAChB,YAAY,EAAEE,SAAS,CAAC,CAAC;EAE7B,OAAOJ,WAAW;AACpB;AAACD,EAAA,CA3DQJ,OAAO;AA6DhB,eAAeA,OAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}